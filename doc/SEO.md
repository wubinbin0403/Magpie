# Magpie SEO ä¼˜åŒ–è®¾è®¡æ–‡æ¡£

## ğŸ“‹ SSR + Hydration æ–¹æ¡ˆ - æ¶æ„è®¾è®¡

### ğŸ¯ æ–¹æ¡ˆæ¦‚è¿°

**æ ¸å¿ƒæ€æƒ³**ï¼šä¸»é¡µé¦–å±æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSEO å‹å¥½ï¼‰ï¼Œç„¶å Hydration æˆ React åº”ç”¨ï¼ˆæ”¯æŒåŠ è½½æ›´å¤šç­‰äº¤äº’åŠŸèƒ½ï¼‰ã€‚

**å·¥ä½œæµç¨‹**ï¼š
1. **é¦–æ¬¡è®¿é—®**ï¼šHono.js æœåŠ¡ç«¯æ¸²æŸ“é¦–å±å†…å®¹ï¼ˆå‰ 20 æ¡é“¾æ¥ï¼‰
2. **é¡µé¢åŠ è½½å®Œæˆ**ï¼šReact æ¥ç®¡é¡µé¢ï¼ˆHydrationï¼‰
3. **ç”¨æˆ·äº¤äº’**ï¼šç‚¹å‡»"åŠ è½½æ›´å¤š"é€šè¿‡ API è·å–æ›´å¤šå†…å®¹
4. **SEO ä¿éšœ**ï¼šçˆ¬è™«çœ‹åˆ°å®Œæ•´çš„é¦–å± HTML

### ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

#### è¯·æ±‚å¤„ç†æµç¨‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Hono.js Server                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ GET / (User-Agent: çˆ¬è™«)                 â”‚
â”‚   â””â”€â†’ è¿”å›å®Œæ•´HTML (æ— JSï¼Œçº¯SEO)         â”‚
â”‚                                          â”‚
â”‚ GET / (User-Agent: æµè§ˆå™¨)               â”‚
â”‚   â””â”€â†’ è¿”å›SSR HTML + Reactåˆå§‹åŒ–æ•°æ®     â”‚
â”‚                                          â”‚
â”‚ GET /api/links?page=2                    â”‚
â”‚   â””â”€â†’ è¿”å›JSON (åˆ†é¡µæ•°æ®)                â”‚
â”‚                                          â”‚
â”‚ GET /search, /admin/*                    â”‚
â”‚   â””â”€â†’ è¿”å›React SPA                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### é¡µé¢ç±»å‹åˆ’åˆ†
| è·¯ç”± | æ¸²æŸ“æ–¹å¼ | SEOéœ€æ±‚ | äº¤äº’éœ€æ±‚ | è¯´æ˜ |
|------|----------|---------|----------|------|
| `/` | SSR + Hydration | â­â­â­â­â­ | â­â­â­â­â­ | ä¸»é¡µï¼Œéœ€è¦SEOå’Œäº¤äº’ |
| `/search` | SPA | â­â­ | â­â­â­â­â­ | æœç´¢é¡µï¼Œå®æ—¶äº¤äº’ä¸ºä¸» |
| `/confirm/*` | SPA | â­ | â­â­â­â­â­ | ç¡®è®¤é¡µï¼Œç¼–è¾‘åŠŸèƒ½ |
| `/admin/*` | SPA | â­ | â­â­â­â­â­ | ç®¡ç†åå°ï¼Œå¤æ‚äº¤äº’ |

### ğŸ’» æ ¸å¿ƒç»„ä»¶è®¾è®¡

#### 1. æœåŠ¡ç«¯æ¸²æŸ“å™¨ (SSRRenderer)
**åŠŸèƒ½**ï¼šæ ¹æ®User-Agentåˆ¤æ–­è®¿é—®è€…ç±»å‹ï¼Œè¿”å›ç›¸åº”çš„HTML

**ä¼ªä»£ç **ï¼š
```
class SSRRenderer {
  function renderHomePage(userAgent) {
    initialData = getInitialPageData() // è·å–å‰20æ¡é“¾æ¥
    
    if (isBot(userAgent)) {
      return renderStaticHTML(initialData) // çº¯HTMLï¼Œæ— JS
    } else {
      return renderHydratableHTML(initialData) // HTML + Reactæ•°æ® + JS
    }
  }
  
  function getInitialPageData() {
    // å¹¶è¡Œè·å–ï¼šå·²å‘å¸ƒé“¾æ¥ã€ç«™ç‚¹è®¾ç½®ã€åˆ†ç±»ç»Ÿè®¡
    // è¿”å›ï¼š{links, settings, categories, hasMore, page}
  }
}
```

#### 2. åŒæ„Reactç»„ä»¶ (HomePage)
**åŠŸèƒ½**ï¼šåŒæ—¶æ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“å’Œå®¢æˆ·ç«¯äº¤äº’

**ä¼ªä»£ç **ï¼š
```
function HomePage({ initialData, isSSR }) {
  state = {
    links: initialData.links,
    page: initialData.page,
    hasMore: initialData.hasMore
  }
  
  function loadMore() {
    if (!hasMore || loading) return
    
    newData = fetch(`/api/links?page=${page + 1}`)
    setState({
      links: [...links, ...newData.links],
      page: page + 1,
      hasMore: newData.hasMore
    })
  }
  
  render() {
    // ä¾§è¾¹æ  + é“¾æ¥åˆ—è¡¨ + åŠ è½½æ›´å¤šæŒ‰é’®
  }
}
```

#### 3. å®¢æˆ·ç«¯æ¿€æ´» (Hydration)
**åŠŸèƒ½**ï¼šå°†æœåŠ¡ç«¯æ¸²æŸ“çš„é™æ€HTMLè½¬æ¢ä¸ºå¯äº¤äº’çš„Reactåº”ç”¨

**ä¼ªä»£ç **ï¼š
```
window.startApp = function() {
  container = document.getElementById('app')
  initialDataScript = document.getElementById('initial-data')
  
  if (initialDataScript) {
    // SSRé¡µé¢ï¼šè¿›è¡ŒHydration
    initialData = JSON.parse(initialDataScript.content)
    hydrateRoot(container, <HomePage initialData={initialData} />)
  } else {
    // SPAé¡µé¢ï¼šæ­£å¸¸æ¸²æŸ“
    createRoot(container).render(<App />)
  }
}
```

#### 4. è·¯ç”±é…ç½®
**åŠŸèƒ½**ï¼šæ ¹æ®ä¸åŒè·¯å¾„è¿”å›ä¸åŒç±»å‹çš„å“åº”

**ä¼ªä»£ç **ï¼š
```
// ä¸»é¡µï¼šSSR
GET '/' -> ssrRenderer.renderHomePage(userAgent)

// APIï¼šJSONæ•°æ®
GET '/api/links' -> return paginated links as JSON

// SPAé¡µé¢ï¼šè¿”å›Reactåº”ç”¨
GET '/search' -> serve React SPA
GET '/admin/*' -> serve React SPA
GET '/confirm/*' -> serve React SPA

// SEOæ–‡ä»¶ï¼šXML/æ–‡æœ¬
GET '/sitemap.xml' -> generate and return sitemap
GET '/robots.txt' -> return robots.txt
GET '/rss.xml' -> generate and return RSS feed
```

### ğŸ”„ ç”¨æˆ·ä½“éªŒæµç¨‹

#### é¦–æ¬¡è®¿é—®æµç¨‹
```
1. ç”¨æˆ·è®¿é—®ä¸»é¡µ '/'
   â†“
2. Hono.jsåˆ¤æ–­User-Agent
   â†“ (æµè§ˆå™¨)              â†“ (çˆ¬è™«)
3. æŸ¥è¯¢æ•°æ®åº“è·å–å‰20æ¡é“¾æ¥    3. æŸ¥è¯¢æ•°æ®åº“è·å–å‰20æ¡é“¾æ¥
   â†“                        â†“
4. ReactæœåŠ¡ç«¯æ¸²æŸ“HTML       4. ç”Ÿæˆçº¯é™æ€HTML
   â†“                        â†“
5. æ³¨å…¥åˆå§‹æ•°æ®åˆ°é¡µé¢         5. è¿”å›çº¯HTMLï¼ˆæ— JSï¼‰
   â†“                        â†“
6. è¿”å›HTML + JSèµ„æº         6. çˆ¬è™«ç´¢å¼•å†…å®¹
   â†“
7. æµè§ˆå™¨åŠ è½½å’Œæ‰§è¡ŒJS
   â†“
8. React Hydrationæ¿€æ´»äº¤äº’
   â†“
9. ç”¨æˆ·å¯ä»¥ç‚¹å‡»"åŠ è½½æ›´å¤š"
```

#### åŠ è½½æ›´å¤šæµç¨‹
```
ç”¨æˆ·ç‚¹å‡»"åŠ è½½æ›´å¤š"
   â†“
å‘é€AJAXè¯·æ±‚ï¼šGET /api/links?page=2
   â†“
æœåŠ¡å™¨è¿”å›JSONï¼š{links, page, hasMore}
   â†“
å®¢æˆ·ç«¯æ›´æ–°çŠ¶æ€ï¼Œè¿½åŠ æ–°é“¾æ¥åˆ°åˆ—è¡¨
   â†“
å¦‚æœhasMore=trueï¼Œæ˜¾ç¤º"åŠ è½½æ›´å¤š"æŒ‰é’®
```

### âœ… æ–¹æ¡ˆä¼˜åŠ¿

1. **å®Œç¾SEOæ”¯æŒ**
   - çˆ¬è™«çœ‹åˆ°å®Œæ•´çš„HTMLå†…å®¹
   - åŒ…å«æ‰€æœ‰å¿…è¦çš„Metaæ ‡ç­¾
   - ç»“æ„åŒ–æ•°æ®å’ŒOpen Graphæ”¯æŒ

2. **ä¼˜ç§€ç”¨æˆ·ä½“éªŒ**
   - é¦–å±å¿«é€Ÿæ˜¾ç¤ºï¼ˆSSRï¼‰
   - åç»­äº¤äº’æµç•…ï¼ˆSPAï¼‰
   - æ”¯æŒ"åŠ è½½æ›´å¤š"ç­‰ç°ä»£äº¤äº’

3. **æŠ€æœ¯ä¼˜åŠ¿**
   - ä¸€å¥—Reactç»„ä»¶åŒæ—¶æ”¯æŒSSRå’ŒCSR
   - æ¸è¿›å¼å¢å¼ºï¼ŒJSå¤±è´¥æ—¶å†…å®¹ä»å¯è§
   - ç¼“å­˜å‹å¥½ï¼Œé™ä½æœåŠ¡å™¨è´Ÿè½½

4. **ç»´æŠ¤æ€§**
   - ç»„ä»¶å¤ç”¨ï¼Œå‡å°‘ä»£ç é‡å¤
   - å¼€å‘ä½“éªŒè‰¯å¥½
   - æ˜“äºæ‰©å±•å’Œä¿®æ”¹

### âš ï¸ å®æ–½è€ƒè™‘

#### å¼€å‘ç¯å¢ƒé…ç½®
- Viteä»£ç†è®¾ç½®ï¼Œå¼€å‘æ—¶ä¸»é¡µè¯·æ±‚è½¬å‘åˆ°HonoæœåŠ¡å™¨
- çƒ­é‡è½½æ”¯æŒï¼Œä¿æŒè‰¯å¥½å¼€å‘ä½“éªŒ

#### æ„å»ºå’Œéƒ¨ç½²
- éœ€è¦æ„å»ºReactåº”ç”¨å’ŒSSRæ¸²æŸ“å™¨
- Dockerå®¹å™¨éœ€è¦åŒ…å«ä¸¤å¥—ä»£ç ï¼ˆå‰ç«¯æ„å»ºäº§ç‰© + åç«¯æ¸²æŸ“é€»è¾‘ï¼‰

#### æ€§èƒ½ä¼˜åŒ–
- é€‚å½“çš„ç¼“å­˜ç­–ç•¥ï¼ˆ5åˆ†é’Ÿé¡µé¢ç¼“å­˜ï¼‰
- æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
- é™æ€èµ„æºé¢„åŠ è½½

#### é”™è¯¯å¤„ç†
- SSRå¤±è´¥æ—¶é™çº§åˆ°å®¢æˆ·ç«¯æ¸²æŸ“
- ç½‘ç»œé”™è¯¯æ—¶çš„å‹å¥½æç¤º
- ç»„ä»¶çŠ¶æ€åŒæ­¥é”™è¯¯å¤„ç†

### ğŸ¯ SEOæœ€ä½³å®è·µ

#### Metaæ ‡ç­¾ä¼˜åŒ–
- æ¯é¡µå”¯ä¸€çš„titleå’Œdescription
- Open Graphå’ŒTwitter Cardæ”¯æŒ
- ç»“æ„åŒ–æ•°æ®ï¼ˆJSON-LDï¼‰ç”¨äºå¯Œåª’ä½“å±•ç¤º

#### æŠ€æœ¯SEO
- å¿«é€Ÿé¦–å±æ¸²æŸ“æ—¶é—´ï¼ˆç›®æ ‡ < 2ç§’ï¼‰
- ç§»åŠ¨ç«¯å“åº”å¼è®¾è®¡
- è¯­ä¹‰åŒ–HTMLç»“æ„
- XML Sitemapè‡ªåŠ¨ç”Ÿæˆ
- RSS Feedæ”¯æŒè®¢é˜…

#### å†…å®¹SEO
- é“¾æ¥æ ‡é¢˜å’Œæè¿°ä¼˜åŒ–
- åˆ†ç±»å’Œæ ‡ç­¾åˆç†ä½¿ç”¨
- å®šæœŸå†…å®¹æ›´æ–°
- å†…éƒ¨é“¾æ¥ç»“æ„ä¼˜åŒ–

è¿™ä¸ªæ–¹æ¡ˆä¸ºMagpieæä¾›äº†å®Œæ•´çš„SEOè§£å†³æ–¹æ¡ˆï¼ŒåŒæ—¶ä¿æŒäº†ç°ä»£SPAçš„ç”¨æˆ·ä½“éªŒã€‚